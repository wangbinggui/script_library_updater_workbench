# 话术示例库更新校验工具

一个基于Flask和pandas的Web应用，用于自动更新话术示例并进行人工校验，判定最终是否更新以及人工修正更新内容。

## 功能特性

### 核心功能
1. **Excel文件上传**：支持上传包含对话数据的Excel表格
2. **智能对比**：自动对比更新前后的话术内容，高亮显示差异
3. **人工校验**：支持采纳、拒绝或手动编辑每一句话术
4. **进度跟踪**：实时显示校验进度
5. **结果导出**：生成包含人工校验结果的Excel文件

### 支持的数据格式
Excel表格需包含以下列：
- `sessionId`：会话ID
- `角色`：客服/客户
- `话术内容`：原始话术
- `变更后的内容`：自动更新后的话术
- `更新情况`：更新状态说明
- `LLM完整输出`：大模型输出的完整信息
- `更新结果检查`：自动检查结果
- `更新结果检查详情`：检查详情说明

## 安装和运行

### 环境要求
- Python 3.7+
- Flask 2.3.3
- pandas 2.1.0
- openpyxl 3.1.2

### 安装步骤

1. **克隆项目**
```bash
git clone <repository-url>
cd script_library_updater_workbench
```

2. **安装依赖**
```bash
pip install -r requirements.txt
```

3. **运行应用**
```bash
python app.py
```

4. **访问应用**
打开浏览器访问：`http://localhost:5000`

## 使用说明

### 1. 上传Excel文件
- 点击上传区域选择Excel文件（支持.xlsx和.xls格式）
- 或直接拖拽文件到上传区域
- 系统会自动验证文件格式和必需列

### 2. 对话校验
- 系统按sessionId分组显示每通对话
- 左侧显示原始内容，右侧显示更新后内容
- 红色高亮显示差异部分
- 查看更新情况、LLM输出、检查结果等元数据

### 3. 人工操作
每一行话术支持三种操作：
- **采纳**：使用自动更新后的内容
- **拒绝**：保留原始内容
- **手动编辑**：打开编辑器进行自定义修改

### 4. 导航和进度
- 使用"上一通"/"下一通"按钮切换对话
- 实时查看校验进度（已完成/总数）

### 5. 导出结果
- 随时点击"生成更新后的表格"导出结果
- 导出的Excel包含原有列及新增的"人工校验修正后的内容"列

## 项目结构

```
script_library_updater_workbench/
├── app.py                 # Flask应用主文件
├── requirements.txt       # 依赖包列表
├── README.md             # 项目说明文档
├── templates/
│   └── index.html        # 前端页面模板
├── static/
│   ├── css/
│   │   └── style.css     # 样式文件
│   └── js/
│       └── script.js     # 前端JavaScript逻辑
└── uploads/              # 上传文件存储目录
```

## 技术架构

### 后端 (Flask)
- **文件处理**：使用pandas读取和处理Excel文件
- **数据管理**：内存中存储当前会话数据
- **API接口**：提供文件上传、数据获取、更新操作等RESTful接口

### 前端 (HTML/CSS/JavaScript)
- **响应式设计**：支持PC和移动端访问
- **交互体验**：拖拽上传、模态框编辑、实时反馈
- **差异显示**：智能高亮显示文本差异

## 特色功能

1. **智能差异检测**：自动识别并高亮显示话术内容的变化
2. **实时编辑**：支持在线编辑话术内容，即时保存
3. **进度可视化**：清晰显示校验进度和完成情况
4. **数据完整性**：自动补充缺失数据，确保数据完整性
5. **用户友好**：直观的界面设计，操作简单易懂

## 注意事项

1. 上传的Excel文件必须包含所有必需的列
2. 文件大小限制为16MB
3. 建议使用现代浏览器以获得最佳体验
4. 校验过程中的数据变更会实时保存

## 开发和扩展

本项目采用模块化设计，便于扩展和维护：
- 后端API可以独立扩展新功能
- 前端组件化设计，易于添加新的交互功能
- 支持自定义样式和主题

## 许可证

本项目采用MIT许可证。详见LICENSE文件。
